<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kwitansi Digital TUNTAS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700;900&display=swap" rel="stylesheet">
    <style>body { font-family: 'Poppins', sans-serif; }</style>
</head>
<body class="bg-slate-100 min-h-screen flex items-center justify-center p-4">

    <div id="loader" class="text-center font-bold text-slate-400">Memuat Kwitansi...</div>

    <div id="kwitansi" class="hidden w-full max-w-sm bg-white rounded-[2rem] shadow-2xl overflow-hidden border-t-8 border-emerald-600">
        <div class="p-8">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-3 text-2xl">
                    <i class="fa-solid fa-check-double"></i>
                </div>
                <h1 class="text-xl font-black text-slate-800 uppercase tracking-tighter">Pembayaran Sukses</h1>
                <p id="vKode" class="text-[10px] font-bold text-slate-400 mt-1"></p>
            </div>

            <div class="space-y-4 border-y border-dashed py-6 my-6">
                <div class="flex justify-between">
                    <span class="text-xs text-slate-400 font-bold uppercase">Nama</span>
                    <span id="vNama" class="text-xs font-bold text-slate-800 text-right"></span>
                </div>
                <div class="flex justify-between">
                    <span class="text-xs text-slate-400 font-bold uppercase">Bulan</span>
                    <span id="vBulan" class="text-xs font-bold text-slate-800"></span>
                </div>
                <div class="flex justify-between">
                    <span class="text-xs text-slate-400 font-bold uppercase">Metode</span>
                    <span class="text-xs font-bold text-emerald-600">Tunai/WhatsApp</span>
                </div>
            </div>

            <div class="text-center">
                <p class="text-[10px] text-slate-400 font-bold uppercase mb-1">Total Nominal</p>
                <h2 id="vNominal" class="text-3xl font-black text-slate-800"></h2>
            </div>
        </div>
        
        <div class="bg-slate-50 p-6 text-center">
            <p class="text-[9px] font-bold text-slate-400 leading-relaxed uppercase">Bukti sah pembayaran iuran sampah RT 04 TUNTAS Sekawan</p>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDjxOJZeiLHaxoaS3-hVdbIGfIXCfCT2Is",
            authDomain: "tuntas-sekawan.firebaseapp.com",
            projectId: "tuntas-sekawan",
            storageBucket: "tuntas-sekawan.firebasestorage.app",
            messagingSenderId: "1090506516563",
            appId: "1:1090506516563:web:63c429677caea28addfea6"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Ambil ID dari URL (?id=T123456)
        const params = new URLSearchParams(window.location.search);
        const idKwitansi = params.get('id');

        if(idKwitansi) {
            db.collection("kwitansi").doc(idKwitansi).get().then((doc) => {
                if (doc.exists) {
                    const data = doc.data();
                    document.getElementById('vNama').innerText = data.nama;
                    document.getElementById('vBulan').innerText = data.bulan;
                    document.getElementById('vNominal').innerText = "Rp " + data.nominal.toLocaleString('id-ID');
                    document.getElementById('vKode').innerText = "NO. REF: " + data.kode;
                    
                    document.getElementById('loader').classList.add('hidden');
                    document.getElementById('kwitansi').classList.remove('hidden');
                } else {
                    document.getElementById('loader').innerText = "Kwitansi tidak ditemukan!";
                }
            });
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/js/all.min.js"></script>
</body>
  </html>
  
